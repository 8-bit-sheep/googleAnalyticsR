<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Setting up Google Analytics API downloads to R â€¢ googleAnalyticsR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Setting up Google Analytics API downloads to R">
<meta property="og:description" content="">
<meta property="og:image" content="https://code.markedmondson.me/googleAnalyticsR/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-47480439-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-47480439-2');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">googleAnalyticsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/setup.html">
    <span class="fa fa-wrench"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-table"></span>
     
    Reporting APIs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/v4.html">
        <span class="fa fa-cogs"></span>
         
        v4 API
      </a>
    </li>
    <li>
      <a href="../articles/v3.html">
        <span class="fa fa-cog"></span>
         
        v3 API
      </a>
    </li>
    <li>
      <a href="../articles/big-query.html">
        <span class="fa fa-search"></span>
         
        BigQuery
      </a>
    </li>
    <li>
      <a href="../articles/ganalytics.html">
        <span class="fa fa-bullseye"></span>
         
        ganalytics
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/management.html">
    <span class="fa fa-briefcase"></span>
     
    Management API
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file"></span>
     
    Publishing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/shiny.html">
        <span class="fa fa-cloud-upload"></span>
         
        Shiny
      </a>
    </li>
    <li>
      <a href="../articles/rmarkdown.html">
        <span class="fa fa-pencil-square"></span>
         
        RMarkdown
      </a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../reference/index.html">
        <span class="fa fa-book-reader"></span>
         
        Function Reference
      </a>
    </li>
    <li>
      <a href="../news/index.html">
        <span class="fa fa-newspaper"></span>
         
        News
      </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Setting up Google Analytics API downloads to R</h1>
            
      
      
      <div class="hidden name"><code>setup.Rmd</code></div>

    </div>

    
    
<p>This guide will walk you through the steps required to properly set up googleAnalyticsR in terms of installation and authentication.</p>
<p>It assumes you have R installed on your machine and access rights to one or more Google Analytics accounts. In this case it will only take a few lines of R code to make a first test call to the GA API following the examples below.</p>
<p>The rest of this guide will give you an overview of the available set up options and cover some good practices to follow under different scenarios of use.</p>
<div id="install" class="section level2">
<h2 class="hasAnchor">
<a href="#install" class="anchor"></a>1. Install</h2>
<p>The latest stable version of <code>googleAnalyticsR</code> is available on CRAN. <img src="http://www.r-pkg.org/badges/version/googleAnalyticsR" alt="CRAN"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"googleAnalyticsR"</span>, <span class="dt">dependencies =</span> <span class="ot">TRUE</span>)</code></pre></div>
<div id="development-version-off-github" class="section level3">
<h3 class="hasAnchor">
<a href="#development-version-off-github" class="anchor"></a>Development version off GitHub</h3>
<p>You may prefer to use the latest development version on GitHub which you can install via the below.</p>
<p>Github check status: <a href="https://travis-ci.org/MarkEdmondson1234/googleAnalyticsR"><img src="https://travis-ci.org/MarkEdmondson1234/googleAnalyticsR.svg?branch=master" alt="Travis-CI Build Status"></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">remotes<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/remotes/topics/install_github">install_github</a></span>(<span class="st">"MarkEdmondson1234/googleAnalyticsR"</span>)</code></pre></div>
<p>Check out the <a href="https://github.com/MarkEdmondson1234/googleAnalyticsR/blob/master/NEWS.md">NEWS</a> to see whats currently available in each version.</p>
</div>
<div id="dependencies" class="section level3">
<h3 class="hasAnchor">
<a href="#dependencies" class="anchor"></a>Dependencies</h3>
<p><code>googleAnalyticsR</code> requires the packages described in the <a href="https://github.com/MarkEdmondson1234/googleAnalyticsR/blob/master/DESCRIPTION"><code>Imports</code> field of the <code>DESCRIPTION</code> file</a> to be installed first, which it will do via <code><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages("googleAnalyticsR", dependencies = TRUE)</a></code></p>
<p>Note that on linux systems, due to its reliance on <a href="https://CRAN.R-project.org/package=httr"><code>httr</code></a> and in turn <a href="https://CRAN.R-project.org/package=curl"><code>curl</code></a>, it may require installation of these dependencies via <code>apt-get</code> or similar: <code>libssl-dev</code> and <code>libcurl4-openssl-dev</code>.</p>
</div>
</div>
<div id="make-first-api-call" class="section level2">
<h2 class="hasAnchor">
<a href="#make-first-api-call" class="anchor"></a>2. Make first API call</h2>
<p>Once you have installed the package you can make a first call to the GA API to test the connection.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## setup
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(googleAnalyticsR)

## This should send you to your browser to authenticate your email. Authenticate with an email that has access to the Google Analytics View you want to use.
<span class="kw"><a href="../reference/ga_auth.html">ga_auth</a></span>()

## get your accounts
account_list &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ga_account_list.html">ga_account_list</a></span>()

## account_list will have a column called "viewId"
account_list<span class="op">$</span>viewId

## View account_list and pick the viewId you want to extract data from. 
ga_id &lt;-<span class="st"> </span><span class="dv">123456</span>

## simple query to test connection
<span class="kw"><a href="../reference/google_analytics.html">google_analytics</a></span>(ga_id,
<span class="dt">date_range =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"2017-01-01"</span>, <span class="st">"2017-03-01"</span>),
<span class="dt">metrics =</span> <span class="st">"sessions"</span>,
<span class="dt">dimensions =</span> <span class="st">"date"</span>)</code></pre></div>
<p>You can find more code examples to query the API in <a href="http://code.markedmondson.me/googleAnalyticsR/articles/v4.html">v4 API</a> and <a href="http://code.markedmondson.me/googleAnalyticsR/articles/v3.html">v3 API</a> sections of the site.</p>
</div>
<div id="choose-authentication-method" class="section level2">
<h2 class="hasAnchor">
<a href="#choose-authentication-method" class="anchor"></a>3. Choose authentication method</h2>
<p>To access the GA API authentication is required.</p>
<p>The example in the previous section used the simplest among the three available ways to authenticate to the API. If you are planning to make systematic use of the API however, itâ€™s worth to know all the available options in order to choose the most suitable.</p>
<p>Note that no matter which method you use, the authentication is actually done via the <a href="http://code.markedmondson.me/googleAuthR/articles/google-authentication-types.html"><code>googleAuthR</code></a> package. In its documentation pages you can read more about advanced use cases.</p>
<div id="authentication-method-1-the-default-googleanalyticsr-project" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-method-1-the-default-googleanalyticsr-project" class="anchor"></a>Authentication method #1: The default googleAnalyticsR project</h3>
<p>The fast authentication way of the previous section worked via the default Google Project for googleAnalyticsR which is shared with all googleAnalyticsR users. Even though it is a shared project other package users are not able to see and access your GA data.</p>
<p>You will not need any credentials and you can directly authenticate using the <code><a href="../reference/ga_auth.html">ga_auth()</a></code> function and your browser. You will not have to go through the browser verification every time though. When you authenticate a <code>ga.oauth</code> file will be created in your working directory. If that file is present, then you will not need to go via Google login when you next use <code><a href="../reference/ga_auth.html">ga_auth()</a></code></p>
</div>
<div id="authentication-method-2-your-own-google-project" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-method-2-your-own-google-project" class="anchor"></a>Authentication method #2: Your own Google Project</h3>
<p>With the amount of API calls possible with this library via batching and walking, its more likely the default shared Google API project will hit the 50,000 calls per day limit.</p>
<p>To mitigate that, use your own Google Developer Console Project key, so it is not shared across all users of this library.</p>
<p><a href="http://donalphipps.co.uk/">Donal Phipps</a> has very kindly created a screencast on how to set this up that you can find embedded below and via <a href="https://www.youtube.com/watch?v=4B88dRbwNfc">this link</a>.</p>
<iframe width="560" height="315" src="http://www.youtube.com/embed/4B88dRbwNfc?rel=0" frameborder="0" allowfullscreen>
</iframe>
<p>Once you obtain the credentials for your project set these options before any call to <code><a href="../reference/ga_auth.html">ga_auth()</a></code> or other data fetching calls.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAuthR.client_id =</span> <span class="st">"uxxxxxxx2fd4kesu6.apps.googleusercontent.com"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAuthR.client_secret =</span> <span class="st">"3JhLa_GxxxxxCQYLe31c64"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAuthR.scopes.selected =</span> <span class="st">"https://www.googleapis.com/auth/analytics"</span>)</code></pre></div>
<p>In the next example, the scopes are also set so a user can authenticate with <a href="http://code.markedmondson.me/searchConsoleR/"><code>searchConsoleR</code></a> at the same time, which is possible as they both use <a href="http://code.markedmondson.me/googleAuthR/"><code>googleAuthR</code></a> as a backend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAuthR.client_id =</span> <span class="st">"tuxxxxxxx2fd4kesu6.apps.googleusercontent.com"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAuthR.client_secret =</span> <span class="st">"3JhLa_GxxxxxCQYLe31c64"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAuthR.scopes.selected =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"https://www.googleapis.com/auth/analytics"</span>,
                                        <span class="st">"https://www.googleapis.com/auth/webmasters"</span>))</code></pre></div>
<p>If you want to use with Shiny, then set the webapp clientId/secrets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAnalyticsR.webapp.client_id =</span> <span class="st">"xxxxx9pcab1u005cv.apps.googleusercontent.com"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/options">options</a></span>(<span class="dt">googleAnalyticsR.webapp.client_secret =</span> <span class="st">"zcofxxxxxxElemXN5sf"</span>)</code></pre></div>
<p>Note: With either shared or personal project using the <code><a href="../reference/ga_auth.html">ga_auth()</a></code> function, you can specify the name and location of your cache file if you pass that to the <code><a href="../reference/ga_auth.html">ga_auth()</a></code> function e.g. <code><a href="../reference/ga_auth.html">ga_auth("auth/my.oauth")</a></code>. This will create your authentication file at the location you specify (relative to your working directory). This can be useful when authenticating within an Rmarkdown document in which case it is recommended to specify your cache file (an Rmarkdown document can change the working directory during knitting).</p>
</div>
<div id="authentication-method-3-google-cloud-service-account" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-method-3-google-cloud-service-account" class="anchor"></a>Authentication method #3: Google Cloud service account</h3>
<p>You can alternatively authenticate by downloading a JSON file attached to a Google Cloud service account. More details on how to do that are on the <a href="http://code.markedmondson.me/googleAuthR/articles/google-authentication-types.html#authentication-with-a-json-file-via-service-accounts"><code>googleAuthR</code> website</a>.</p>
<p>A service authentication file then needs to be created that has edit access to the GA account. It is recommended to make a dedicated service account if you donâ€™t need it for anything else.</p>
<ol style="list-style-type: decimal">
<li>Create your own Google Cloud Project or use an existing one.</li>
<li>Set your own client.id/secret via <code><a href="https://code.markedmondson.me/googleAuthR//reference/gar_set_client.html">googleAuthR::gar_set_client()</a></code>
</li>
<li>Service accounts for your project can be created at this link: <code>https://console.cloud.google.com/iam-admin/serviceaccounts/create</code>
</li>
<li>The service account does not need any GCP account permissions (we do that in next step when we add to GA)</li>
<li>After you can see your service account in the list, create a JSON key for that service account and download it somewhere safe</li>
<li>Copy the service email e.g. <code>ga-access@your-project.iam.gserviceaccount.com</code>
</li>
<li>Login to Google Analytics and add the email to your account at the level of permissions you want. If you want to upload data or update filters etc. then it needs at least edit permissions, if it just needs to read data then Viewer access is fine.</li>
<li>Make sure the GCP project the service key is for has both the Analytics API and the Analytics Reporting API access enabled. You can reach this via the Google API &amp; Services dashboard URL: <code>https://console.developers.google.com/apis/dashboard</code>
</li>
</ol>
<p>You should now be able to use the JSON auth file to authenticate with Google Analytics API via:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(googleAnalyticsR)
googleAuthR<span class="op">::</span><span class="kw"><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth_service.html">gar_auth_service</a></span>(<span class="st">"your_auth_file.json"</span>)

<span class="co"># test authentication</span>
al &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ga_account_list.html">ga_account_list</a></span>()</code></pre></div>
<p>Note: A service account is a special type of account that belongs to an application rather than an individual user. If you should use this option, chances are you are already familiar with how they work. If however you wish to find out more about when and how to use service accounts, follow the link to the Google Cloud documentation page on <a href="https://cloud.google.com/iam/docs/understanding-service-accounts">Understanding Service Accounts</a></p>
</div>
</div>
<div id="optional-review-useful-auth-options" class="section level2">
<h2 class="hasAnchor">
<a href="#optional-review-useful-auth-options" class="anchor"></a>4 (optional): Review useful auth options</h2>
<p>This section covers some other aspects of authentication under various scenarios of use. This information is useful especially if you work systematically with Google Analytics and possibly other Google products too.</p>
<div id="auto-authentication" class="section level3">
<h3 class="hasAnchor">
<a href="#auto-authentication" class="anchor"></a>Auto-authentication</h3>
<p>If you often use the library to access the same accounts from one machine, then it is helpful to setup auto-authentication. This is also the most reliable way for scheduled scripts. It means you do not need to use <code><a href="../reference/ga_auth.html">ga_auth()</a></code>.</p>
<p>A short video on how to do this is available here: <a href="https://www.youtube.com/watch?v=zgwDQu-mCOc">googleAnalyticsR - how to do auto-authentication</a></p>
<iframe width="560" height="315" src="http://www.youtube.com/embed/zgwDQu-mCOc?rel=0" frameborder="0" allowfullscreen>
</iframe>
<p>You choose to auto-authenticate by moving your authentication cache file to a global location on your computer, that all future R sessions will use, then telling <code>googleAnalyticsR</code> where that file is when it is loaded into your R session.</p>
<p>This is done by creating an environment variable called <code>GA_AUTH_FILE</code> that points at your valid cache file.</p>
<p>You can set environment variables using a <code>.Renviron</code> file or via the function <code><a href="https://www.rdocumentation.org/packages/base/topics/Sys.setenv">Sys.setenv()</a></code> - see <code><a href="https://www.rdocumentation.org/packages/base/topics/Startup">?Startup</a></code> for details. The first method is described below:</p>
<ol style="list-style-type: decimal">
<li>Choose your authentication cache file - either one you have generated via <code><a href="../reference/ga_auth.html">ga_auth()</a></code> or your own Google Projectâ€™s service account JSON ending with file extension <code>.json</code>
</li>
<li>Create a file called <code>.Renviron</code> and place it in your userâ€™s home directory (<code>~</code> on OSX/linux or <code>C:\\</code> on Windows). If using RStudio, you can find your the correct location directory by clicking on the <code>Home</code> breadcrumb link in your File Explorer panel or with the <code><a href="https://www.rdocumentation.org/packages/base/topics/path.expand">path.expand("~")</a></code> command.</li>
<li>Place the absolute location of the file from step 1 into the <code>.Renviron</code> file, e.g. <code>GA_AUTH_FILE = "/Users/mark/dev/auth/ga.oauth"</code>.</li>
<li>Save the file and restart your R session.</li>
</ol>
<p>If all goes well you should see something similar to this when you load <code>googleAnalyticsR</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(googleAnalyticsR)
<span class="co">#&gt;Successfully authenticated via /Users/mark/dev/auth/ga.oauth</span>

## can do authenticated calls straight away
al &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ga_account_list.html">ga_account_list</a></span>()</code></pre></div>
</div>
<div id="multiple-api-authentification" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-api-authentification" class="anchor"></a>Multiple API authentification</h3>
<p>If you are using more than one API for authentication (such as Search Console), then authenticate using <code><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth.html">googleAuthR::gar_auth()</a></code> instead, to ensure you authenticate with the correct scopes. See the <a href="http://code.markedmondson.me/googleAuthR/articles/google-authentication-types.html#multiple-authentication-tokens">multiple authentication</a> section on the <code>googleAuthR</code> website for details.</p>
<p>If you have set up a personal project then you can use the <code><a href="https://www.rdocumentation.org/packages/base/topics/options">options()</a></code> function as shown in the previous section</p>
</div>
<div id="multiple-ga-accounts" class="section level3">
<h3 class="hasAnchor">
<a href="#multiple-ga-accounts" class="anchor"></a>Multiple GA accounts</h3>
<p>If you ever need to authenticate with a new user, use <code><a href="../reference/ga_auth.html">ga_auth(new_user=TRUE)</a></code></p>
<p>If you systematically need to fetch from several different Google analytics accounts, the easiest way to handle authentication is to have the websites all available under one email. If that is not possible, then you can run through the authentication steps twice, and name your auth tokens different names. You will need to unset the GA_AUTH_FILE in your .Renviron if you have one by either commenting it out or removing the line. You can then authenticate separately using <code><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth.html">googleAuthR::gar_auth()</a></code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(googleAnalyticsR)
googleAuthR<span class="op">::</span><span class="kw"><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth.html">gar_auth</a></span>(<span class="st">"~/auth/client_one.httr-oauth"</span>)

client_one &lt;-<span class="st"> </span><span class="kw"><a href="../reference/google_analytics.html">google_analytics</a></span>(ga_id_one, <span class="dt">date_range =</span> my_date_range,
<span class="dt">metrics =</span> <span class="st">"sessions"</span>, <span class="dt">dimensions =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"date"</span>, <span class="st">"medium"</span>))

googleAuthR<span class="op">::</span><span class="kw"><a href="https://code.markedmondson.me/googleAuthR//reference/gar_auth.html">gar_auth</a></span>(<span class="st">"~/auth/client_two.httr-oauth"</span>)

client_two &lt;-<span class="st"> </span><span class="kw"><a href="../reference/google_analytics.html">google_analytics</a></span>(ga_id_two, <span class="dt">date_range =</span> my_date_range,
<span class="dt">metrics =</span> <span class="st">"sessions"</span>, <span class="dt">dimensions =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"date"</span>, <span class="st">"medium"</span>))</code></pre></div>
</div>
<div id="authentication-with-shiny-and-rmarkdown" class="section level3">
<h3 class="hasAnchor">
<a href="#authentication-with-shiny-and-rmarkdown" class="anchor"></a>Authentication with shiny and Rmarkdown</h3>
<p>More details about these special cases of authentication are available on the corresponding sections of this site for <a href="http://code.markedmondson.me/googleAnalyticsR/articles/shiny.html">Shiny</a> and <a href="http://code.markedmondson.me/googleAnalyticsR/articles/rmarkdown.html">Rmarkdown</a></p>
</div>
</div>
<div id="optional-explore-the-ga-metrics-and-dimensions" class="section level2">
<h2 class="hasAnchor">
<a href="#optional-explore-the-ga-metrics-and-dimensions" class="anchor"></a>5 (optional): Explore the GA metrics and dimensions</h2>
<p>To see what dimensions and metrics are available via the API as well as their precise definition, you can use this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get a list of what metrics and dimensions you can use
meta &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ga_meta.html">google_analytics_meta</a></span>()</code></pre></div>
<div class="figure">
<img src="meta_data_screenshot.png">
</div>
<p>If offline, this data is also available by typing <code>meta</code>, although it wonâ€™t be quite as up to date.</p>
<p>The meta data does not include multi-channel as they are not available, for those <a href="https://developers.google.com/analytics/devguides/reporting/mcf/dimsmets/">see the online version</a>.</p>
<p>When using the library, you can call metrics and dimensions with or without the <code>ga:</code> prefix (<code>mcf:</code> for multi-channel metrics/dimensions.)</p>
<div id="where-to-go-from-here" class="section level3">
<h3 class="hasAnchor">
<a href="#where-to-go-from-here" class="anchor"></a>Where to go from here ?</h3>
<p>Once the set up is complete you are ready to start using the package to access your GA data. To give you some ideas the <a href="http://code.markedmondson.me/googleAnalyticsR/articles/v4.html">v4 API page</a> of this site provides several examples of key functionalities provided by the package.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#install">1. Install</a></li>
      <li><a href="#make-first-api-call">2. Make first API call</a></li>
      <li><a href="#choose-authentication-method">3. Choose authentication method</a></li>
      <li><a href="#optional-review-useful-auth-options">4 (optional): Review useful auth options</a></li>
      <li><a href="#optional-explore-the-ga-metrics-and-dimensions">5 (optional): Explore the GA metrics and dimensions</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Setting up Google Analytics API downloads to R. googleAnalyticsR</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet"><script src="../../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container">
      <header><div class="navbar navbar-inverse  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../../index.html">googleAnalyticsR</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../../index.html">
    <span class="fa fa-home"></span>
     
    Home
  </a>
</li>
<li>
  <a href="../../articles/setup.html">
    <span class="fa fa-wrench"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Reporting API
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../../articles/v4.html">
        <span class="fa fa-cogs"></span>
         
        v4
      </a>
    </li>
    <li>
      <a href="../../articles/v3.html">
        <span class="fa fa-cog"></span>
         
        v3
      </a>
    </li>
  </ul></li>
<li>
  <a href="../../articles/big-query.html">
    <span class="fa fa-search"></span>
     
    Big Query
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Reporting
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../../articles/shiny.html">
        <span class="fa fa-cloud-upload"></span>
         
        Shiny
      </a>
    </li>
    <li>
      <a href="../../articles/rmarkdown.html">
        <span class="fa fa-pencil-square"></span>
         
        RMarkdown
      </a>
    </li>
  </ul></li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../../reference/index.html">
        <span class="fa fa-question-circle"></span>
         
        Reference
      </a>
    </li>
    <li>
      <a href="../../news/index.html">
        <span class="fa fa-newspaper-o"></span>
         
        News
      </a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->
      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Setting up Google Analytics API downloads to R</h1>
            
          </div>

    
    
<div id="install" class="section level2">
<h2>Install</h2>
<p>The latest stable version of googleAnalyticsR is available on CRAN. <img src="http://www.r-pkg.org/badges/version/googleAnalyticsR" alt="CRAN"></p>
<p>You also need the version &gt; <code>0.3.0</code> of <code>googleAuthR</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"googleAuthR"</span>)
<span class="kw">install.packages</span>(<span class="st">"googleAnalyticsR"</span>)</code></pre></div>
<div id="development-version-off-github" class="section level3">
<h3>Development version off github</h3>
<p>You may prefer to use the latest development version is on github which you can install via the below.</p>
<p>Github check status: <a href="https://travis-ci.org/MarkEdmondson1234/googleAnalyticsR"><img src="https://travis-ci.org/MarkEdmondson1234/googleAnalyticsR.svg?branch=master" alt="Travis-CI Build Status"></a></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"MarkEdmondson1234/googleAnalyticsR"</span>)</code></pre></div>
<p>Check out the <a href="https://github.com/MarkEdmondson1234/googleAnalyticsR/blob/master/NEWS.md">NEWS</a> to see whats currently available in each version.</p>
</div>
</div>
<div id="authentication" class="section level2">
<h2>Authentication</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## setup
<span class="kw">library</span>(googleAnalyticsR)

## This should send you to your browser to authenticate your email.
## Authenticate with an email that has access to the Google Analytics View you want to use.
<span class="kw"><a href="../../reference/ga_auth.html">ga_auth</a></span>()

## get your accounts
account_list &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/google_analytics_account_list.html">google_analytics_account_list</a></span>()

## pick a profile with data to query
ga_id &lt;-<span class="st"> </span>account_list[<span class="dv">23</span>,<span class="st">'viewId'</span>]</code></pre></div>
<p>Should you need to authenticate under a new user, use <code><a href="../../reference/ga_auth.html">ga_auth(new_user=TRUE)</a></code></p>
</div>
<div id="auto-authentication" class="section level2">
<h2>Auto-authentication</h2>
<p>From version <code>0.4</code> (currently on Github) you can choose to auto-authenticate by moving your <code>.httr-oauth</code> or by creating a Google OAuth service account JSON file.</p>
<p>Once you have set the environment variable <code>GA_AUTH_FILE</code> to a valid file location, the function will look there for authentication details upon loading the library meaning you will not need to call <code><a href="../../reference/ga_auth.html">ga_auth()</a></code> yourself as you would normally.</p>
<p>You can set environment variables using a <code>.Renviron</code> file or via the function <code>Sys.setenv()</code></p>
<p>An example <code>.Renviron</code> file is below - this is placed in your root directory (<code>~/</code> or <code>C:\\</code>)</p>
<p><code>GA_AUTH_FILE = "/Users/bob/auth/googleAnalyticsR.httr-oauth"</code></p>
<p><code>GA_AUTH_FILE</code> can be either the file path to a <code>.httr-oauth</code> token generated by <code>gar_auth()</code> or your own Google Project&rsquo;s service account JSON ending with file extension <code>.json</code></p>
<p>If you use the service account JSON, you will also need to add the service account email via your Google Analytics admin as a user to see data e.g. <code>xxxx@yyyyyy.iam.gserviceaccount.com</code></p>
</div>
<div id="meta-data" class="section level2">
<h2>Meta data</h2>
<p>To see what dimensions and metrics are available via the API, you can use this command:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## get a list of what metrics and dimensions you can use
<span class="kw"><a href="../../reference/ga_auth.html">ga_auth</a></span>()
meta &lt;-<span class="st"> </span><span class="kw"><a href="../../reference/google_analytics_meta.html">google_analytics_meta</a></span>()</code></pre></div>
<div class="figure">
<img src="/Users/IIH-Nordic/dev/googleAnalyticsR/vignettes/website/meta_data_screenshot.png"></div>
<p>If offline, from <code>v0.2.0</code> this data is also available offline by typing <code>meta</code>, although it won&rsquo;t be quite as up to date.</p>
<p>The meta data does not include multi-channel as they are not available to download, for those <a href="https://developers.google.com/analytics/devguides/reporting/mcf/dimsmets/">see the online version</a>.</p>
<p>When using the library, you can call metrics and dimensions with or without the <code>ga:</code> prefix (<code>mcf:</code> for multi-channel metrics/dimensions.)</p>
<div id="multiple-api-authentication" class="section level3">
<h3>Multiple API authentication</h3>
<p>If you are using more than one API for authentication (such as Search Console), then authenticate using <code>googleAuthR::gar_auth()</code> instead, to ensure you are authenticate with the correct scopes.</p>
</div>
</div>
<div id="using-your-own-google-developer-project-api-key" class="section level2">
<h2>Using your own Google Developer Project API Key</h2>
<p>With the amount of API calls possible with this library via batching and walking, its more likely the default shared Google API project will hit the 50,000 calls per day limit.</p>
<p>To mitigate that, use your own Google Developer Console Project key, so it is not shared across all users of this library.</p>
<div id="example-adding-your-own-google-developer-console-keys" class="section level3">
<h3>Example adding your own Google Developer Console keys</h3>
<p>Set the options before any call to <code><a href="../../reference/ga_auth.html">ga_auth()</a></code> or other data fetching calls.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">googleAuthR.client_id =</span> <span class="st">"uxxxxxxx2fd4kesu6.apps.googleusercontent.com"</span>)
<span class="kw">options</span>(<span class="dt">googleAuthR.client_secret =</span> <span class="st">"3JhLa_GxxxxxCQYLe31c64"</span>)
<span class="kw">options</span>(<span class="dt">googleAuthR.scopes.selected =</span> <span class="st">"https://www.googleapis.com/auth/analytics"</span>)</code></pre></div>
<p>In the next example, the scopes are also set so a user can authenticate with <code>searchConsoleR</code> at the same time, which is possible as they both use <a href="http://code.markedmondson.me/googleAuthR/">googleAuthR</a> as a backend.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">googleAuthR.client_id =</span> <span class="st">"tuxxxxxxx2fd4kesu6.apps.googleusercontent.com"</span>)
<span class="kw">options</span>(<span class="dt">googleAuthR.client_secret =</span> <span class="st">"3JhLa_GxxxxxCQYLe31c64"</span>)
<span class="kw">options</span>(<span class="dt">googleAuthR.scopes.selected =</span> <span class="kw">c</span>(<span class="st">"https://www.googleapis.com/auth/analytics"</span>,
                                        <span class="st">"https://www.googleapis.com/auth/webmasters"</span>))</code></pre></div>
<p>If you want to use with Shiny, then set the webapp clientId/secrets.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">options</span>(<span class="dt">googleAnalyticsR.webapp.client_id =</span> <span class="st">"xxxxx9pcab1u005cv.apps.googleusercontent.com"</span>)
<span class="kw">options</span>(<span class="dt">googleAnalyticsR.webapp.client_secret =</span> <span class="st">"zcofxxxxxxElemXN5sf"</span>)</code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs">
        <div id="tocnav">
      <h2>Contents</h2>
      <ul class="nav nav-pills nav-stacked"><li><a href="#install">Install</a></li>
      <li><a href="#authentication">Authentication</a></li>
      <li><a href="#auto-authentication">Auto-authentication</a></li>
      <li><a href="#meta-data">Meta data</a></li>
      <li><a href="#using-your-own-google-developer-project-api-key">Using your own Google Developer Project API Key</a></li>
      </ul></div>
      </div>

</div>


      <footer><p>Built by <a href="http://hadley.github.io/pkgdown/">pkgdown</a>. Styled with <a href="http://getbootstrap.com">Bootstrap 3</a>.</p>
      </footer></div>

  </body></html>

<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Make a Google Analytics v4 API fetch — make_ga_4_req • googleAnalyticsR</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Make a Google Analytics v4 API fetch — make_ga_4_req" />
<meta property="og:description" content="This function constructs the Google Analytics API v4 call to be called
  via fetch_google_analytics_4" />
<meta property="og:image" content="https://code.markedmondson.me/googleAnalyticsR/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-47480439-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-47480439-2');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">googleAnalyticsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.8.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/setup.html">
    <span class="fas fa-wrench"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-table"></span>
     
    Reporting APIs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/reporting-ga4.html">
        <span class="fas fa-digital-tachograph"></span>
         
        GA4 Data API
      </a>
    </li>
    <li>
      <a href="../articles/v4.html">
        <span class="fas fa-cogs"></span>
         
        v4 API
      </a>
    </li>
    <li>
      <a href="../articles/user-activity.html">
        <span class="fas fa-user"></span>
         
        User Activity API
      </a>
    </li>
    <li>
      <a href="../articles/v3.html">
        <span class="fas fa-cog"></span>
         
        v3 API
      </a>
    </li>
    <li>
      <a href="../articles/big-query.html">
        <span class="fas fa-search"></span>
         
        BigQuery
      </a>
    </li>
    <li>
      <a href="../articles/ganalytics.html">
        <span class="fas fa-bullseye"></span>
         
        ganalytics
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/management.html">
    <span class="fas fa-briefcase"></span>
     
    Management API
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-file"></span>
     
    Publishing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/shiny.html">
        <span class="fas fa-cloud-upload"></span>
         
        Shiny
      </a>
    </li>
    <li>
      <a href="../articles/rmarkdown.html">
        <span class="fas fa-pencil-square"></span>
         
        RMarkdown
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/models.html">
    <span class="fas fa-calculator"></span>
     
    Models
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fas fa-question-circle"></span>
     
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/index.html">
        <span class="fas fa-book-reader"></span>
         
        Function Reference
      </a>
    </li>
    <li>
      <a href="../news/index.html">
        <span class="fas fa-newspaper"></span>
         
        News
      </a>
    </li>
    <li>
      <a href="../articles/faq.html">
        <span class="fas fa-glasses"></span>
         
        FAQs
      </a>
    </li>
    <li>
      <a href="../articles/practical-tips.html">
        <span class="fas fa-bicycle"></span>
         
        Practical tips
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/MarkEdmondson1234/googleAnalyticsR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Make a Google Analytics v4 API fetch</h1>
    <small class="dont-index">Source: <a href='https://github.com/MarkEdmondson1234/googleAnalyticsR/blob/master/R/ga_v4_get.R'><code>R/ga_v4_get.R</code></a></small>
    <div class="hidden name"><code>make_ga_4_req.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function constructs the Google Analytics API v4 call to be called
  via <a href='fetch_google_analytics_4.html'>fetch_google_analytics_4</a></p>
    </div>

    <pre class="usage"><span class='fu'>make_ga_4_req</span><span class='op'>(</span>
  <span class='va'>viewId</span>,
  date_range <span class='op'>=</span> <span class='cn'>NULL</span>,
  metrics <span class='op'>=</span> <span class='cn'>NULL</span>,
  dimensions <span class='op'>=</span> <span class='cn'>NULL</span>,
  dim_filters <span class='op'>=</span> <span class='cn'>NULL</span>,
  met_filters <span class='op'>=</span> <span class='cn'>NULL</span>,
  filtersExpression <span class='op'>=</span> <span class='cn'>NULL</span>,
  order <span class='op'>=</span> <span class='cn'>NULL</span>,
  segments <span class='op'>=</span> <span class='cn'>NULL</span>,
  pivots <span class='op'>=</span> <span class='cn'>NULL</span>,
  cohorts <span class='op'>=</span> <span class='cn'>NULL</span>,
  pageToken <span class='op'>=</span> <span class='fl'>0</span>,
  pageSize <span class='op'>=</span> <span class='fl'>1000</span>,
  samplingLevel <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"DEFAULT"</span>, <span class='st'>"SMALL"</span>, <span class='st'>"LARGE"</span><span class='op'>)</span>,
  metricFormat <span class='op'>=</span> <span class='cn'>NULL</span>,
  histogramBuckets <span class='op'>=</span> <span class='cn'>NULL</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>viewId</th>
      <td><p>viewId of data to get.</p></td>
    </tr>
    <tr>
      <th>date_range</th>
      <td><p>character or date vector of format <code><a href='https://rdrr.io/r/base/c.html'>c(start, end)</a></code> or 
for two date ranges: <code><a href='https://rdrr.io/r/base/c.html'>c(start1,end1,start2,end2)</a></code></p></td>
    </tr>
    <tr>
      <th>metrics</th>
      <td><p>Metric(s) to fetch as a character vector.  You do not need to 
supply the <code>"ga:"</code> prefix.  See <a href='meta.html'>meta</a> for a list of dimensons 
and metrics the API supports. Also supports your own calculated metrics.</p></td>
    </tr>
    <tr>
      <th>dimensions</th>
      <td><p>Dimension(s) to fetch as a character vector. You do not need to 
supply the <code>"ga:"</code> prefix. See <a href='meta.html'>meta</a> for a list of dimensons 
and metrics the API supports.</p></td>
    </tr>
    <tr>
      <th>dim_filters</th>
      <td><p>A <a href='filter_clause_ga4.html'>filter_clause_ga4</a> wrapping <a href='dim_filter.html'>dim_filter</a></p></td>
    </tr>
    <tr>
      <th>met_filters</th>
      <td><p>A <a href='filter_clause_ga4.html'>filter_clause_ga4</a> wrapping <a href='met_filter.html'>met_filter</a></p></td>
    </tr>
    <tr>
      <th>filtersExpression</th>
      <td><p>A v3 API style simple filter string. Not used with other filters.</p></td>
    </tr>
    <tr>
      <th>order</th>
      <td><p>An <a href='order_type.html'>order_type</a> object</p></td>
    </tr>
    <tr>
      <th>segments</th>
      <td><p>List of segments as created by <a href='segment_ga4.html'>segment_ga4</a></p></td>
    </tr>
    <tr>
      <th>pivots</th>
      <td><p>Pivots of the data as created by <a href='pivot_ga4.html'>pivot_ga4</a></p></td>
    </tr>
    <tr>
      <th>cohorts</th>
      <td><p>Cohorts created by <a href='make_cohort_group.html'>make_cohort_group</a></p></td>
    </tr>
    <tr>
      <th>pageToken</th>
      <td><p>Where to start the data fetch</p></td>
    </tr>
    <tr>
      <th>pageSize</th>
      <td><p>How many rows to fetch. Max 100000 each batch.</p></td>
    </tr>
    <tr>
      <th>samplingLevel</th>
      <td><p>Sample level</p></td>
    </tr>
    <tr>
      <th>metricFormat</th>
      <td><p>If supplying calculated metrics, specify the metric type</p></td>
    </tr>
    <tr>
      <th>histogramBuckets</th>
      <td><p>For numeric dimensions such as hour, a list of buckets of data.
See details in make_ga_4_req</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="metrics"><a class="anchor" href="#metrics"></a>Metrics</h2>

    

<p>Metrics support calculated metrics like ga:users / ga:sessions if you supply
  them in a named vector.</p>
<p>You must supply the correct 'ga:' prefix unlike normal metrics</p>
<p>You can mix calculated and normal metrics like so:</p>
<p><code>customMetric &lt;- c(sessionPerVisitor = "ga:sessions / ga:visitors",
                          "bounceRate",
                          "entrances")</code></p>
<p>You can also optionally supply a <code>metricFormat</code> parameter that must be
   the same length as the metrics.  <code>metricFormat</code> can be:
   <code>METRIC_TYPE_UNSPECIFIED, INTEGER, FLOAT, CURRENCY, PERCENT, TIME</code></p>
<p>All metrics are currently parsed to as.numeric when in R.</p>
    <h2 class="hasAnchor" id="dimensions"><a class="anchor" href="#dimensions"></a>Dimensions</h2>

    


<p>Supply a character vector of dimensions, with or without <code>ga:</code> prefix.</p>
<p>Optionally for numeric dimension types such as
  <code>ga:hour, ga:browserVersion, ga:sessionsToTransaction</code>, etc. supply
  histogram buckets suitable for histogram plots.</p>
<p>If non-empty, we place dimension values into buckets after string to int64.
  Dimension values that are not the string representation of an integral value
  will be converted to zero. The bucket values have to be in increasing order.
  Each bucket is closed on the lower end, and open on the upper end.
  The "first" bucket includes all values less than the first boundary,
  the "last" bucket includes all values up to infinity.
  Dimension values that fall in a bucket get transformed to a new dimension
  value. For example, if one gives a list of "0, 1, 3, 4, 7", then we
  return the following buckets: -</p><ul>
<li><p>bucket #1: values &lt; 0, dimension value "&lt;0"</p></li>
<li><p>bucket #2: values in [0,1), dimension value "0"</p></li>
<li><p>bucket #3: values in [1,3), dimension value "1-2"</p></li>
<li><p>bucket #4: values in [3,4), dimension value "3"</p></li>
<li><p>bucket #5: values in [4,7), dimension value "4-6"</p></li>
<li><p>bucket #6: values &gt;= 7, dimension value "7+"</p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other GAv4 fetch functions: 
<code><a href='fetch_google_analytics_4_slow.html'>fetch_google_analytics_4_slow</a>()</code>,
<code><a href='fetch_google_analytics_4.html'>fetch_google_analytics_4</a>()</code>,
<code><a href='google_analytics.html'>google_analytics</a>()</code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://code.markedmondson.me/googleAnalyticsR/'>googleAnalyticsR</a></span><span class='op'>)</span>

<span class='co'>## authenticate, </span>
<span class='co'>## or use the RStudio Addin "Google API Auth" with analytics scopes set</span>
<span class='fu'><a href='ga_auth.html'>ga_auth</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>## get your accounts</span>
<span class='va'>account_list</span> <span class='op'>&lt;-</span> <span class='fu'><a href='ga_account_list.html'>ga_account_list</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'>## pick a profile with data to query</span>

<span class='va'>ga_id</span> <span class='op'>&lt;-</span> <span class='va'>account_list</span><span class='op'>[</span><span class='fl'>23</span>,<span class='st'>'viewId'</span><span class='op'>]</span>

<span class='va'>ga_req1</span> <span class='op'>&lt;-</span> <span class='fu'>make_ga_4_req</span><span class='op'>(</span><span class='va'>ga_id</span>, 
                         date_range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2015-07-30"</span>,<span class='st'>"2015-10-01"</span><span class='op'>)</span>,
                         dimensions<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'source'</span>,<span class='st'>'medium'</span><span class='op'>)</span>, 
                         metrics <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'sessions'</span><span class='op'>)</span><span class='op'>)</span>

<span class='va'>ga_req2</span> <span class='op'>&lt;-</span> <span class='fu'>make_ga_4_req</span><span class='op'>(</span><span class='va'>ga_id</span>, 
                         date_range <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"2015-07-30"</span>,<span class='st'>"2015-10-01"</span><span class='op'>)</span>,
                         dimensions<span class='op'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'source'</span>,<span class='st'>'medium'</span><span class='op'>)</span>, 
                         metrics <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>'users'</span><span class='op'>)</span><span class='op'>)</span>
                         
<span class='fu'><a href='fetch_google_analytics_4.html'>fetch_google_analytics_4</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='va'>ga_req1</span>, <span class='va'>ga_req2</span><span class='op'>)</span><span class='op'>)</span>

<span class='op'>}</span>


</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>



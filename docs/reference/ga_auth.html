<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Authenticate with Google Analytics OAuth2 — ga_auth • googleAnalyticsR</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Authenticate with Google Analytics OAuth2 — ga_auth" />

<meta property="og:description" content="A wrapper for gar_auth and gar_auth_service" />

<meta property="og:image" content="https://code.markedmondson.me/googleAnalyticsR/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-47480439-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-47480439-2');
</script>

  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">googleAnalyticsR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.6.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/setup.html">
    <span class="fa fa-wrench"></span>
     
    Setup
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-table"></span>
     
    Reporting APIs
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/v4.html">
        <span class="fa fa-cogs"></span>
         
        v4 API
      </a>
    </li>
    <li>
      <a href="../articles/user-activity.html">
        <span class="fa fa-user"></span>
         
        User Activity API
      </a>
    </li>
    <li>
      <a href="../articles/v3.html">
        <span class="fa fa-cog"></span>
         
        v3 API
      </a>
    </li>
    <li>
      <a href="../articles/big-query.html">
        <span class="fa fa-search"></span>
         
        BigQuery
      </a>
    </li>
    <li>
      <a href="../articles/ganalytics.html">
        <span class="fa fa-bullseye"></span>
         
        ganalytics
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/management.html">
    <span class="fa fa-briefcase"></span>
     
    Management API
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-file"></span>
     
    Publishing
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/shiny.html">
        <span class="fa fa-cloud-upload"></span>
         
        Shiny
      </a>
    </li>
    <li>
      <a href="../articles/rmarkdown.html">
        <span class="fa fa-pencil-square"></span>
         
        RMarkdown
      </a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/models.html">
    <span class="fa fa-calculator"></span>
     
    Models
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-question-circle"></span>
     
    Help
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../reference/index.html">
        <span class="fa fa-book-reader"></span>
         
        Function Reference
      </a>
    </li>
    <li>
      <a href="../news/index.html">
        <span class="fa fa-newspaper"></span>
         
        News
      </a>
    </li>
    <li>
      <a href="../articles/faq.html">
        <span class="fa fa-glasses"></span>
         
        FAQs
      </a>
    </li>
    <li>
      <a href="../articles/practical-tips.html">
        <span class="fa fa-bicycle"></span>
         
        Practical tips
      </a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Authenticate with Google Analytics OAuth2</h1>
    
    <div class="hidden name"><code>ga_auth.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>A wrapper for <a href='https://code.markedmondson.me/googleAuthR//reference/gar_auth.html'>gar_auth</a> and <a href='https://code.markedmondson.me/googleAuthR//reference/gar_auth_service.html'>gar_auth_service</a></p>
    
    </div>

    <pre class="usage"><span class='fu'>ga_auth</span>(<span class='kw'>token</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>email</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>token</th>
      <td><p>An existing token or file location of a token to authenticate with</p></td>
    </tr>
    <tr>
      <th>email</th>
      <td><p>An existing cached email to authenticate with or <code>TRUE</code> to authenticate with only email available.  If not set then you will get an interactive prompt asking you to choose which email to authenticate with.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Invisibly, the token that has been saved to the session</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Run this function first time to authenticate with Google in your browser.</p>
<p>After initial authentication, your authentication details will be kept globally for use later, tied to your email, and the next time you authenticate you will be given a prompt to choose which email to authentcate from.  Set <code>email="your@email.com"</code> to skip the interactive prompt.</p>
    
    <h2 class="hasAnchor" id="multiple-accounts"><a class="anchor" href="#multiple-accounts"></a>Multiple accounts</h2>

    
    <p>You can authenticate with a new email for each account. Supply a different email to use those details for your session.</p>
    
    <h2 class="hasAnchor" id="service-accounts"><a class="anchor" href="#service-accounts"></a>Service accounts</h2>

    
    <p>If you use the service account JSON, you will need to add the service account email 
  to your Google Analytics users to see data e.g. <code>xxxx@yyyyyy.iam.gserviceaccount.com</code></p>
    
    <h2 class="hasAnchor" id="auto-authentication"><a class="anchor" href="#auto-authentication"></a>Auto-authentication</h2>

    
    <p>You can choose to auto-authenticate by creating a Google OAuth service account JSON file.</p>
<p>Specify an environment variable in R via a <code>.Renviron</code> file or using <a href='https://www.rdocumentation.org/packages/base/topics/Sys.setenv'>Sys.setenv</a> which points to the file location of your chosen authentication file.  See <a href='https://www.rdocumentation.org/packages/base/topics/Startup'>Startup</a></p>
<p>Once you have set the environment variable <code>GA_AUTH_FILE</code> to a valid file location,
  the function will look there for authentication details upon loading the library meaning 
  you will not need to call <code>ga_auth()</code> yourself as you would normally.</p>
<p>An example <code>.Renviron</code> file is below:</p>
<p><code>GA_AUTH_FILE = "/Users/bob/auth/googleAnalyticsR.json"</code></p>
<p><code>GA_AUTH_FILE</code> can be a service account JSON ending with file extension <code>.json</code>.  Make sure to give the service account email access to your Google Analytics account as mentioned above.</p>
    
    <h2 class="hasAnchor" id="your-own-google-project"><a class="anchor" href="#your-own-google-project"></a>Your own Google Project</h2>

    
    <p>Be default the Google Project used is shared by all users, so you may find it runs out of API calls.  
To mitigate that, create your own Google Project and turn on the Analytics APIs.</p>
<p>The best way to do this is to use <a href='https://code.markedmondson.me/googleAuthR//reference/gar_set_client.html'>gar_set_client</a> by downloading your JSON client credentials and setting them to be found on package startup via the <code>GAR_CLIENT_JSON</code> environment argument.  See <code><a href='https://code.markedmondson.me/googleAuthR//reference/gar_set_client.html'>?googleAuthR::gar_set_client</a></code> function help pages for details.</p>
<p>Or you can then copy your Google Cloud Project's client ID and client secret, to place in options or environment arguments (whichever is easiest)</p>
<p>The environment args are below.  Similar to auto-authentication, you can place your entries in an <code>.Renviron</code> file</p>
<p><code>
GA_CLIENT_ID="XXXX"
GA_CLIENT_SECRET="XXX"
GA_WEB_CLIENT_ID="XXX"
GA_WEB_CLIENT_SECRET="XXX"
</code></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
</div><span class='co'># NOT RUN {</span>
<span class='co'># to use default package credentials (for testing)</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>googleAnalyticsR</span>)
<span class='fu'>ga_auth</span>()

<span class='co'># to use your own Google Cloud Project credentials</span>
<span class='co'># go to GCP console and download client credentials JSON </span>
<span class='co'># ideally set this in .Renviron file, not here but just for demonstration</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/Sys.setenv'>Sys.setenv</a></span>(<span class='st'>"GAR_CLIENT_JSON"</span> <span class='kw'>=</span> <span class='st'>"location/of/file.json"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>googleAnalyticsR</span>)
<span class='co'># should now be able to log in via your own GCP project</span>
<span class='fu'>ga_auth</span>()

<span class='co'># reauthentication</span>
<span class='co'># Once you have authenticated, set email to skip the interactive message</span>
<span class='fu'>ga_auth</span>(<span class='kw'>email</span> <span class='kw'>=</span> <span class='st'>"my@email.com"</span>)

<span class='co'># or leave unset to bring up menu on which email to auth with</span>
<span class='fu'>ga_auth</span>()
<span class='co'># The googleAnalyticsR package is requesting access to your Google account. </span>
<span class='co'># Select a pre-authorised account or enter '0' to obtain a new token.</span>
<span class='co'># Press Esc/Ctrl + C to abort.</span>
<span class='co'>#1: my@email.com</span>
<span class='co'>#2: work@mybusiness.com</span>
<span class='co'># you can set authentication for many emails, then switch between them e.g.</span>
<span class='fu'>ga_auth</span>(<span class='kw'>email</span> <span class='kw'>=</span> <span class='st'>"my@email.com"</span>)
<span class='fu'><a href='ga_account_list.html'>ga_account_list</a></span>() <span class='co'># lists one set of accounts</span>
<span class='fu'>ga_auth</span>(<span class='kw'>email</span> <span class='kw'>=</span> <span class='st'>"work@mybusiness.com"</span>)
<span class='fu'><a href='ga_account_list.html'>ga_account_list</a></span>() <span class='co'># lists second set of accounts</span>



<span class='co'># }</span><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#multiple-accounts">Multiple accounts</a></li>

      <li><a href="#service-accounts">Service accounts</a></li>

      <li><a href="#auto-authentication">Auto-authentication</a></li>

      <li><a href="#your-own-google-project">Your own Google Project</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Mark Edmondson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

